| distributed init (rank 0): env://
Creating model
load checkpoint from X-VLM/data/models/cub/checkpoint_best.pth
missing_keys:  []
unexpected_keys:  []
### Total Params:  213959547
Creating retrieval dataset
### output_dir,  X-VLM/data/models/cub/
Start evaluating
### be careful: func create_loader returns a list length of 1
Computing features for evaluation...
Evaluation: [   0/2856]  eta: 0:01:47    time: 0.0376  data: 0.0041  max mem: 5299
Evaluation: [  50/2856]  eta: 0:00:37    time: 0.0131  data: 0.0000  max mem: 5299
Evaluation: [ 100/2856]  eta: 0:00:36    time: 0.0130  data: 0.0000  max mem: 5299
Evaluation: [ 150/2856]  eta: 0:00:35    time: 0.0128  data: 0.0000  max mem: 5299
Evaluation: [ 200/2856]  eta: 0:00:34    time: 0.0129  data: 0.0000  max mem: 5299
Evaluation: [ 250/2856]  eta: 0:00:34    time: 0.0129  data: 0.0000  max mem: 5299
Evaluation: [ 300/2856]  eta: 0:00:33    time: 0.0128  data: 0.0000  max mem: 5299
Evaluation: [ 350/2856]  eta: 0:00:32    time: 0.0129  data: 0.0000  max mem: 5299
Evaluation: [ 400/2856]  eta: 0:00:31    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [ 450/2856]  eta: 0:00:31    time: 0.0129  data: 0.0000  max mem: 5299
Evaluation: [ 500/2856]  eta: 0:00:30    time: 0.0130  data: 0.0000  max mem: 5299
Evaluation: [ 550/2856]  eta: 0:00:29    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [ 600/2856]  eta: 0:00:29    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [ 650/2856]  eta: 0:00:28    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [ 700/2856]  eta: 0:00:27    time: 0.0130  data: 0.0000  max mem: 5299
Evaluation: [ 750/2856]  eta: 0:00:27    time: 0.0130  data: 0.0000  max mem: 5299
Evaluation: [ 800/2856]  eta: 0:00:26    time: 0.0129  data: 0.0000  max mem: 5299
Evaluation: [ 850/2856]  eta: 0:00:25    time: 0.0129  data: 0.0000  max mem: 5299
Evaluation: [ 900/2856]  eta: 0:00:25    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [ 950/2856]  eta: 0:00:24    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [1000/2856]  eta: 0:00:23    time: 0.0129  data: 0.0000  max mem: 5299
Evaluation: [1050/2856]  eta: 0:00:23    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [1100/2856]  eta: 0:00:22    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [1150/2856]  eta: 0:00:21    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [1200/2856]  eta: 0:00:21    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [1250/2856]  eta: 0:00:20    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [1300/2856]  eta: 0:00:19    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [1350/2856]  eta: 0:00:19    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [1400/2856]  eta: 0:00:18    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [1450/2856]  eta: 0:00:17    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [1500/2856]  eta: 0:00:17    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [1550/2856]  eta: 0:00:16    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [1600/2856]  eta: 0:00:16    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [1650/2856]  eta: 0:00:15    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [1700/2856]  eta: 0:00:14    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [1750/2856]  eta: 0:00:14    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [1800/2856]  eta: 0:00:13    time: 0.0124  data: 0.0000  max mem: 5299
Evaluation: [1850/2856]  eta: 0:00:12    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [1900/2856]  eta: 0:00:12    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [1950/2856]  eta: 0:00:11    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [2000/2856]  eta: 0:00:10    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [2050/2856]  eta: 0:00:10    time: 0.0124  data: 0.0000  max mem: 5299
Evaluation: [2100/2856]  eta: 0:00:09    time: 0.0124  data: 0.0000  max mem: 5299
Evaluation: [2150/2856]  eta: 0:00:08    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [2200/2856]  eta: 0:00:08    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [2250/2856]  eta: 0:00:07    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [2300/2856]  eta: 0:00:07    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [2350/2856]  eta: 0:00:06    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [2400/2856]  eta: 0:00:05    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [2450/2856]  eta: 0:00:05    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [2500/2856]  eta: 0:00:04    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [2550/2856]  eta: 0:00:03    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [2600/2856]  eta: 0:00:03    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [2650/2856]  eta: 0:00:02    time: 0.0124  data: 0.0000  max mem: 5299
Evaluation: [2700/2856]  eta: 0:00:01    time: 0.0124  data: 0.0000  max mem: 5299
Evaluation: [2750/2856]  eta: 0:00:01    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [2800/2856]  eta: 0:00:00    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [2850/2856]  eta: 0:00:00    time: 0.0124  data: 0.0000  max mem: 5299
Evaluation: [2855/2856]  eta: 0:00:00    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: Total time: 0:00:36 (0.0127 s / it)
Evaluation: [   0/2856]  eta: 0:00:52    time: 0.0184  data: 0.0042  max mem: 5299
Evaluation: [  50/2856]  eta: 0:00:34    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [ 100/2856]  eta: 0:00:34    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [ 150/2856]  eta: 0:00:33    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [ 200/2856]  eta: 0:00:33    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [ 250/2856]  eta: 0:00:32    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [ 300/2856]  eta: 0:00:32    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [ 350/2856]  eta: 0:00:31    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [ 400/2856]  eta: 0:00:30    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [ 450/2856]  eta: 0:00:29    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [ 500/2856]  eta: 0:00:29    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [ 550/2856]  eta: 0:00:28    time: 0.0122  data: 0.0000  max mem: 5299
Evaluation: [ 600/2856]  eta: 0:00:28    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [ 650/2856]  eta: 0:00:27    time: 0.0124  data: 0.0000  max mem: 5299
Evaluation: [ 700/2856]  eta: 0:00:26    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [ 750/2856]  eta: 0:00:26    time: 0.0124  data: 0.0000  max mem: 5299
Evaluation: [ 800/2856]  eta: 0:00:25    time: 0.0124  data: 0.0000  max mem: 5299
Evaluation: [ 850/2856]  eta: 0:00:24    time: 0.0124  data: 0.0000  max mem: 5299
Evaluation: [ 900/2856]  eta: 0:00:24    time: 0.0124  data: 0.0000  max mem: 5299
Evaluation: [ 950/2856]  eta: 0:00:23    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [1000/2856]  eta: 0:00:23    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [1050/2856]  eta: 0:00:22    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [1100/2856]  eta: 0:00:21    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [1150/2856]  eta: 0:00:21    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [1200/2856]  eta: 0:00:20    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [1250/2856]  eta: 0:00:19    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [1300/2856]  eta: 0:00:19    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [1350/2856]  eta: 0:00:18    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [1400/2856]  eta: 0:00:18    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [1450/2856]  eta: 0:00:17    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [1500/2856]  eta: 0:00:16    time: 0.0124  data: 0.0000  max mem: 5299
Evaluation: [1550/2856]  eta: 0:00:16    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [1600/2856]  eta: 0:00:15    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [1650/2856]  eta: 0:00:15    time: 0.0122  data: 0.0000  max mem: 5299
Evaluation: [1700/2856]  eta: 0:00:14    time: 0.0122  data: 0.0000  max mem: 5299
Evaluation: [1750/2856]  eta: 0:00:13    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [1800/2856]  eta: 0:00:13    time: 0.0124  data: 0.0000  max mem: 5299
Evaluation: [1850/2856]  eta: 0:00:12    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [1900/2856]  eta: 0:00:11    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [1950/2856]  eta: 0:00:11    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [2000/2856]  eta: 0:00:10    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [2050/2856]  eta: 0:00:10    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [2100/2856]  eta: 0:00:09    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [2150/2856]  eta: 0:00:08    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [2200/2856]  eta: 0:00:08    time: 0.0126  data: 0.0000  max mem: 5299
Evaluation: [2250/2856]  eta: 0:00:07    time: 0.0128  data: 0.0000  max mem: 5299
Evaluation: [2300/2856]  eta: 0:00:06    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [2350/2856]  eta: 0:00:06    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [2400/2856]  eta: 0:00:05    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [2450/2856]  eta: 0:00:05    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [2500/2856]  eta: 0:00:04    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [2550/2856]  eta: 0:00:03    time: 0.0128  data: 0.0000  max mem: 5299
Evaluation: [2600/2856]  eta: 0:00:03    time: 0.0127  data: 0.0000  max mem: 5299
Evaluation: [2650/2856]  eta: 0:00:02    time: 0.0125  data: 0.0000  max mem: 5299
Evaluation: [2700/2856]  eta: 0:00:01    time: 0.0124  data: 0.0000  max mem: 5299
Evaluation: [2750/2856]  eta: 0:00:01    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [2800/2856]  eta: 0:00:00    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [2850/2856]  eta: 0:00:00    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: [2855/2856]  eta: 0:00:00    time: 0.0123  data: 0.0000  max mem: 5299
Evaluation: Total time: 0:00:35 (0.0125 s / it)
Evaluation time 0:02:47
Saved ranks to  X-VLM/data/models/cub/eval_ranks_i2t.pkl
Saved ranks to  X-VLM/data/models/cub/eval_ranks_t2i.pkl
{'txt_r1': 1.050420168067227, 'txt_r5': 1.680672268907563, 'txt_r10': 1.7857142857142858, 'txt_r_mean': 1.5056022408963585, 'img_r1': 0.7352941176470589, 'img_r5': 1.1904761904761905, 'img_r10': 1.365546218487395, 'img_r_mean': 1.0971055088702146, 'r_mean': 1.3013538748832865}
### Time 0:02:48
NNODES,  1
NPROC_PER_NODE,  8
MASTER_ADDR,  SET_IT
MASTER_PORT,  12345
NODE_RANK,  0
### warning: the settings for distributed training is not filled (ignore this if you only use one node)
### warning: you have not set the path to hadoop_bin (ignore this if you don't use HDFS)
