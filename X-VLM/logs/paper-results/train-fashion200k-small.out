| distributed init (rank 0): env://
Creating model
### Loading pretrained vision encoder
Position interpolate vision_encoder.layers.0.blocks.0.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.0.blocks.1.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.1.blocks.0.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.1.blocks.1.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.0.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.1.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.2.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.3.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.4.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.5.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.6.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.7.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.8.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.9.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.10.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.11.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.12.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.13.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.14.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.15.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.16.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.17.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.3.blocks.0.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.3.blocks.1.attn.relative_position_bias_table from 13x13 to 23x23
### Loading pretrained text encoder
load checkpoint from /ivi/ilps/personal/mbiriuk/repro/X-VLM/4m_base_model_state_step_199999.th
missing_keys:  []
unexpected_keys:  ['bbox_head.0.weight', 'bbox_head.0.bias', 'bbox_head.1.weight', 'bbox_head.1.bias', 'bbox_head.3.weight', 'bbox_head.3.bias', 'text_encoder.cls.predictions.bias', 'text_encoder.cls.predictions.transform.dense.weight', 'text_encoder.cls.predictions.transform.dense.bias', 'text_encoder.cls.predictions.transform.LayerNorm.weight', 'text_encoder.cls.predictions.transform.LayerNorm.bias', 'text_encoder.cls.predictions.decoder.weight', 'text_encoder.cls.predictions.decoder.bias']
### Total Params:  213959547
Creating retrieval dataset
### output_dir,  output/zh/fashion200k_small
Start training
### data 30, batch size, 2 x 1
### lr_mult,  2
### num_training_steps,  15
### num_warmup_steps,  1
Train Epoch: [0] [ 0/15]  eta: 0:00:36  lr: 0.000030  loss_itm: 0.3711  loss_itc: 0.0007  time: 2.4528  data: 1.4023  max mem: 4164
Train Epoch: [0] [14/15]  eta: 0:00:00  lr: 0.000000  loss_itm: 0.2531  loss_itc: 0.1241  time: 0.5917  data: 0.0935  max mem: 6279
Train Epoch: [0] Total time: 0:00:08 (0.5919 s / it)
Averaged stats: lr: 0.0000  loss_itm: 0.3683  loss_itc: 0.1971
Computing features for evaluation...
Evaluation: [ 0/10]  eta: 0:00:00    time: 0.0162  data: 0.0001  max mem: 6279
Evaluation: [ 9/10]  eta: 0:00:00    time: 0.0124  data: 0.0000  max mem: 6279
Evaluation: Total time: 0:00:00 (0.0125 s / it)
Evaluation: [ 0/10]  eta: 0:00:00    time: 0.0130  data: 0.0000  max mem: 6279
Evaluation: [ 9/10]  eta: 0:00:00    time: 0.0121  data: 0.0000  max mem: 6279
Evaluation: Total time: 0:00:00 (0.0121 s / it)
Evaluation time 0:00:01
Computing features for evaluation...
Evaluation: [   0/5000]  eta: 0:01:42    time: 0.0205  data: 0.0073  max mem: 10557
Evaluation: [  50/5000]  eta: 0:00:59    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 100/5000]  eta: 0:00:58    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 150/5000]  eta: 0:00:58    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 200/5000]  eta: 0:00:57    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 250/5000]  eta: 0:00:56    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 300/5000]  eta: 0:00:56    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 350/5000]  eta: 0:00:55    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [ 400/5000]  eta: 0:00:54    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 450/5000]  eta: 0:00:54    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [ 500/5000]  eta: 0:00:53    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 550/5000]  eta: 0:00:53    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 600/5000]  eta: 0:00:52    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 650/5000]  eta: 0:00:51    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 700/5000]  eta: 0:00:51    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 750/5000]  eta: 0:00:50    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 800/5000]  eta: 0:00:50    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 850/5000]  eta: 0:00:49    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 900/5000]  eta: 0:00:48    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 950/5000]  eta: 0:00:48    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1000/5000]  eta: 0:00:47    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1050/5000]  eta: 0:00:47    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1100/5000]  eta: 0:00:46    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1150/5000]  eta: 0:00:45    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1200/5000]  eta: 0:00:45    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1250/5000]  eta: 0:00:44    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1300/5000]  eta: 0:00:44    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1350/5000]  eta: 0:00:43    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1400/5000]  eta: 0:00:42    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1450/5000]  eta: 0:00:42    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1500/5000]  eta: 0:00:41    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1550/5000]  eta: 0:00:41    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1600/5000]  eta: 0:00:40    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1650/5000]  eta: 0:00:39    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1700/5000]  eta: 0:00:39    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1750/5000]  eta: 0:00:38    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1800/5000]  eta: 0:00:38    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1850/5000]  eta: 0:00:37    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1900/5000]  eta: 0:00:37    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1950/5000]  eta: 0:00:36    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2000/5000]  eta: 0:00:35    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2050/5000]  eta: 0:00:35    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2100/5000]  eta: 0:00:34    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2150/5000]  eta: 0:00:34    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2200/5000]  eta: 0:00:33    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2250/5000]  eta: 0:00:32    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2300/5000]  eta: 0:00:32    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2350/5000]  eta: 0:00:31    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2400/5000]  eta: 0:00:31    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2450/5000]  eta: 0:00:30    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2500/5000]  eta: 0:00:29    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2550/5000]  eta: 0:00:29    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2600/5000]  eta: 0:00:28    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2650/5000]  eta: 0:00:28    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2700/5000]  eta: 0:00:27    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2750/5000]  eta: 0:00:26    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2800/5000]  eta: 0:00:26    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2850/5000]  eta: 0:00:25    time: 0.0122  data: 0.0000  max mem: 10557
Evaluation: [2900/5000]  eta: 0:00:25    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2950/5000]  eta: 0:00:24    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3000/5000]  eta: 0:00:23    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3050/5000]  eta: 0:00:23    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3100/5000]  eta: 0:00:22    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3150/5000]  eta: 0:00:22    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3200/5000]  eta: 0:00:21    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3250/5000]  eta: 0:00:20    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3300/5000]  eta: 0:00:20    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3350/5000]  eta: 0:00:19    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3400/5000]  eta: 0:00:19    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3450/5000]  eta: 0:00:18    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3500/5000]  eta: 0:00:17    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3550/5000]  eta: 0:00:17    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3600/5000]  eta: 0:00:16    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3650/5000]  eta: 0:00:16    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3700/5000]  eta: 0:00:15    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3750/5000]  eta: 0:00:14    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3800/5000]  eta: 0:00:14    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3850/5000]  eta: 0:00:13    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3900/5000]  eta: 0:00:13    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3950/5000]  eta: 0:00:12    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4000/5000]  eta: 0:00:11    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4050/5000]  eta: 0:00:11    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4100/5000]  eta: 0:00:10    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4150/5000]  eta: 0:00:10    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4200/5000]  eta: 0:00:09    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4250/5000]  eta: 0:00:08    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4300/5000]  eta: 0:00:08    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4350/5000]  eta: 0:00:07    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4400/5000]  eta: 0:00:07    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4450/5000]  eta: 0:00:06    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4500/5000]  eta: 0:00:05    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4550/5000]  eta: 0:00:05    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4600/5000]  eta: 0:00:04    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4650/5000]  eta: 0:00:04    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4700/5000]  eta: 0:00:03    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4750/5000]  eta: 0:00:02    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4800/5000]  eta: 0:00:02    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4850/5000]  eta: 0:00:01    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4900/5000]  eta: 0:00:01    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4950/5000]  eta: 0:00:00    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4999/5000]  eta: 0:00:00    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: Total time: 0:00:59 (0.0119 s / it)
Evaluation: [   0/5000]  eta: 0:01:39    time: 0.0198  data: 0.0073  max mem: 10557
Evaluation: [  50/5000]  eta: 0:01:00    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [ 100/5000]  eta: 0:00:59    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 150/5000]  eta: 0:00:58    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 200/5000]  eta: 0:00:57    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 250/5000]  eta: 0:00:57    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 300/5000]  eta: 0:00:56    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [ 350/5000]  eta: 0:00:55    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 400/5000]  eta: 0:00:55    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [ 450/5000]  eta: 0:00:54    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [ 500/5000]  eta: 0:00:53    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [ 550/5000]  eta: 0:00:53    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 600/5000]  eta: 0:00:52    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [ 650/5000]  eta: 0:00:52    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [ 700/5000]  eta: 0:00:51    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [ 750/5000]  eta: 0:00:50    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [ 800/5000]  eta: 0:00:50    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [ 850/5000]  eta: 0:00:49    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 900/5000]  eta: 0:00:49    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [ 950/5000]  eta: 0:00:48    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1000/5000]  eta: 0:00:47    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1050/5000]  eta: 0:00:47    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1100/5000]  eta: 0:00:46    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1150/5000]  eta: 0:00:46    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1200/5000]  eta: 0:00:45    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1250/5000]  eta: 0:00:44    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1300/5000]  eta: 0:00:44    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1350/5000]  eta: 0:00:43    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1400/5000]  eta: 0:00:43    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1450/5000]  eta: 0:00:42    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1500/5000]  eta: 0:00:41    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1550/5000]  eta: 0:00:41    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1600/5000]  eta: 0:00:40    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1650/5000]  eta: 0:00:40    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1700/5000]  eta: 0:00:39    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1750/5000]  eta: 0:00:38    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1800/5000]  eta: 0:00:38    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1850/5000]  eta: 0:00:37    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [1900/5000]  eta: 0:00:37    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [1950/5000]  eta: 0:00:36    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2000/5000]  eta: 0:00:35    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2050/5000]  eta: 0:00:35    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2100/5000]  eta: 0:00:34    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2150/5000]  eta: 0:00:34    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2200/5000]  eta: 0:00:33    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2250/5000]  eta: 0:00:32    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2300/5000]  eta: 0:00:32    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2350/5000]  eta: 0:00:31    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2400/5000]  eta: 0:00:31    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2450/5000]  eta: 0:00:30    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2500/5000]  eta: 0:00:29    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2550/5000]  eta: 0:00:29    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2600/5000]  eta: 0:00:28    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2650/5000]  eta: 0:00:28    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2700/5000]  eta: 0:00:27    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2750/5000]  eta: 0:00:26    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2800/5000]  eta: 0:00:26    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2850/5000]  eta: 0:00:25    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [2900/5000]  eta: 0:00:25    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [2950/5000]  eta: 0:00:24    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3000/5000]  eta: 0:00:23    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3050/5000]  eta: 0:00:23    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3100/5000]  eta: 0:00:22    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3150/5000]  eta: 0:00:22    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3200/5000]  eta: 0:00:21    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3250/5000]  eta: 0:00:20    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3300/5000]  eta: 0:00:20    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3350/5000]  eta: 0:00:19    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3400/5000]  eta: 0:00:19    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3450/5000]  eta: 0:00:18    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3500/5000]  eta: 0:00:17    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3550/5000]  eta: 0:00:17    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3600/5000]  eta: 0:00:16    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3650/5000]  eta: 0:00:16    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3700/5000]  eta: 0:00:15    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3750/5000]  eta: 0:00:14    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3800/5000]  eta: 0:00:14    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3850/5000]  eta: 0:00:13    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [3900/5000]  eta: 0:00:13    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [3950/5000]  eta: 0:00:12    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4000/5000]  eta: 0:00:11    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4050/5000]  eta: 0:00:11    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4100/5000]  eta: 0:00:10    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4150/5000]  eta: 0:00:10    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4200/5000]  eta: 0:00:09    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4250/5000]  eta: 0:00:08    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4300/5000]  eta: 0:00:08    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4350/5000]  eta: 0:00:07    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4400/5000]  eta: 0:00:07    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4450/5000]  eta: 0:00:06    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4500/5000]  eta: 0:00:05    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4550/5000]  eta: 0:00:05    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4600/5000]  eta: 0:00:04    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4650/5000]  eta: 0:00:04    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4700/5000]  eta: 0:00:03    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4750/5000]  eta: 0:00:02    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4800/5000]  eta: 0:00:02    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4850/5000]  eta: 0:00:01    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: [4900/5000]  eta: 0:00:01    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4950/5000]  eta: 0:00:00    time: 0.0119  data: 0.0000  max mem: 10557
Evaluation: [4999/5000]  eta: 0:00:00    time: 0.0120  data: 0.0000  max mem: 10557
Evaluation: Total time: 0:00:59 (0.0120 s / it)
Evaluation time 0:05:52
Saved ranks to  output/zh/fashion200k_small/eval_ranks_i2t.pkl
Saved ranks to  output/zh/fashion200k_small/eval_ranks_t2i.pkl
{'txt_r1': 60.0, 'txt_r5': 80.0, 'txt_r10': 100.0, 'txt_r_mean': 80.0, 'img_r1': 70.0, 'img_r5': 90.0, 'img_r10': 100.0, 'img_r_mean': 86.66666666666667, 'r_mean': 83.33333333333334}
Saved ranks to  output/zh/fashion200k_small/eval_ranks_i2t.pkl
Saved ranks to  output/zh/fashion200k_small/eval_ranks_t2i.pkl
{'txt_r1': 1.34, 'txt_r5': 2.26, 'txt_r10': 2.34, 'txt_r_mean': 1.9799999999999998, 'img_r1': 2.56, 'img_r5': 4.16, 'img_r10': 4.28, 'img_r_mean': 3.6666666666666665, 'r_mean': 2.8233333333333333}
{"train_lr": "0.00002", "train_loss_itm": "0.30497", "train_loss_itc": "0.17663", "val_txt_r1": 7.351940095302927, "val_txt_r5": 22.123893805309734, "val_txt_r10": 32.13070115724983, "val_txt_r_mean": 20.535511685954166, "val_img_r1": 7.147719537100068, "val_img_r5": 22.396187882913548, "val_img_r10": 33.390061266167464, "val_img_r_mean": 20.977989562060362, "val_r_mean": 20.756750624007264, "test_txt_r1": 7.177871148459384, "test_txt_r5": 21.673669467787114, "test_txt_r10": 32.00280112044818, "test_txt_r_mean": 20.284780578898225, "test_img_r1": 7.3879551820728295, "test_img_r5": 22.443977591036415, "test_img_r10": 33.19327731092437, "test_img_r_mean": 21.008403361344538, "test_r_mean": 20.64659197012138, "epoch": 0}
best epoch: 0{"train_lr": "0.00002", "train_loss_itm": "0.36832", "train_loss_itc": "0.19709", "val_txt_r1": 70.0, "val_txt_r5": 100.0, "val_txt_r10": 100.0, "val_txt_r_mean": 90.0, "val_img_r1": 70.0, "val_img_r5": 90.0, "val_img_r10": 100.0, "val_img_r_mean": 86.66666666666667, "val_r_mean": 88.33333333333334, "test_txt_r1": 80.0, "test_txt_r5": 100.0, "test_txt_r10": 100.0, "test_txt_r_mean": 93.33333333333333, "test_img_r1": 80.0, "test_img_r5": 100.0, "test_img_r10": 100.0, "test_img_r_mean": 93.33333333333333, "test_r_mean": 93.33333333333333, "epoch": 0}
best epoch: 0{"train_lr": "0.00002", "train_loss_itm": "0.36832", "train_loss_itc": "0.19709", "val_txt_r1": 60.0, "val_txt_r5": 80.0, "val_txt_r10": 100.0, "val_txt_r_mean": 80.0, "val_img_r1": 70.0, "val_img_r5": 90.0, "val_img_r10": 100.0, "val_img_r_mean": 86.66666666666667, "val_r_mean": 83.33333333333334, "test_txt_r1": 1.34, "test_txt_r5": 2.26, "test_txt_r10": 2.34, "test_txt_r_mean": 1.9799999999999998, "test_img_r1": 2.56, "test_img_r5": 4.16, "test_img_r10": 4.28, "test_img_r_mean": 3.6666666666666665, "test_r_mean": 2.8233333333333333, "epoch": 0}
best epoch: 0### Time 0:06:07
NNODES,  1
NPROC_PER_NODE,  8
MASTER_ADDR,  SET_IT
MASTER_PORT,  12345
NODE_RANK,  0
### warning: the settings for distributed training is not filled (ignore this if you only use one node)
### warning: you have not set the path to hadoop_bin (ignore this if you don't use HDFS)
