| distributed init (rank 0): env://
Creating model
load checkpoint from /home/mbiriuk/X-VLM/output/itr_fashion200k_small/checkpoint_best.pth
missing_keys:  []
unexpected_keys:  []
### Total Params:  213959547
Creating retrieval dataset
### output_dir,  output/itr_fashion200k_small
Start evaluating
### be careful: func create_loader returns a list length of 1
Computing features for evaluation...
Evaluation: [   0/2856]  eta: 0:01:08    time: 0.0239  data: 0.0038  max mem: 5303
Evaluation: [  50/2856]  eta: 0:11:07    time: 0.2421  data: 0.0000  max mem: 5303
Evaluation: [ 100/2856]  eta: 0:11:01    time: 0.2423  data: 0.0000  max mem: 5303
Evaluation: [ 150/2856]  eta: 0:10:52    time: 0.2432  data: 0.0000  max mem: 5303
Evaluation: [ 200/2856]  eta: 0:10:41    time: 0.2431  data: 0.0000  max mem: 5303
Evaluation: [ 250/2856]  eta: 0:10:30    time: 0.2441  data: 0.0000  max mem: 5303
Evaluation: [ 300/2856]  eta: 0:10:19    time: 0.2452  data: 0.0000  max mem: 5303
Evaluation: [ 350/2856]  eta: 0:10:09    time: 0.2477  data: 0.0000  max mem: 5303
Evaluation: [ 400/2856]  eta: 0:09:58    time: 0.2487  data: 0.0000  max mem: 5303
Evaluation: [ 450/2856]  eta: 0:09:47    time: 0.2483  data: 0.0000  max mem: 5303
Evaluation: [ 500/2856]  eta: 0:09:36    time: 0.2478  data: 0.0000  max mem: 5303
Evaluation: [ 550/2856]  eta: 0:09:25    time: 0.2493  data: 0.0000  max mem: 5303
Evaluation: [ 600/2856]  eta: 0:09:13    time: 0.2495  data: 0.0000  max mem: 5303
Evaluation: [ 650/2856]  eta: 0:09:02    time: 0.2499  data: 0.0000  max mem: 5303
Evaluation: [ 700/2856]  eta: 0:08:50    time: 0.2485  data: 0.0000  max mem: 5303
Evaluation: [ 750/2856]  eta: 0:08:38    time: 0.2488  data: 0.0000  max mem: 5303
Evaluation: [ 800/2856]  eta: 0:08:26    time: 0.2487  data: 0.0000  max mem: 5303
Evaluation: [ 850/2856]  eta: 0:08:14    time: 0.2494  data: 0.0000  max mem: 5303
Evaluation: [ 900/2856]  eta: 0:08:02    time: 0.2506  data: 0.0000  max mem: 5303
Evaluation: [ 950/2856]  eta: 0:07:50    time: 0.2497  data: 0.0000  max mem: 5303
Evaluation: [1000/2856]  eta: 0:07:38    time: 0.2494  data: 0.0000  max mem: 5303
Evaluation: [1050/2856]  eta: 0:07:26    time: 0.2509  data: 0.0000  max mem: 5303
Evaluation: [1100/2856]  eta: 0:07:14    time: 0.2499  data: 0.0000  max mem: 5303
Evaluation: [1150/2856]  eta: 0:07:02    time: 0.2499  data: 0.0000  max mem: 5303
Evaluation: [1200/2856]  eta: 0:06:49    time: 0.2487  data: 0.0000  max mem: 5303
Evaluation: [1250/2856]  eta: 0:06:37    time: 0.2490  data: 0.0000  max mem: 5303
Evaluation: [1300/2856]  eta: 0:06:25    time: 0.2503  data: 0.0000  max mem: 5303
Evaluation: [1350/2856]  eta: 0:06:12    time: 0.2498  data: 0.0000  max mem: 5303
Evaluation: [1400/2856]  eta: 0:06:00    time: 0.2498  data: 0.0000  max mem: 5303
Evaluation: [1450/2856]  eta: 0:05:48    time: 0.2493  data: 0.0000  max mem: 5303
Evaluation: [1500/2856]  eta: 0:05:36    time: 0.2483  data: 0.0000  max mem: 5303
Evaluation: [1550/2856]  eta: 0:05:23    time: 0.2505  data: 0.0000  max mem: 5303
Evaluation: [1600/2856]  eta: 0:05:11    time: 0.2486  data: 0.0000  max mem: 5303
Evaluation: [1650/2856]  eta: 0:04:59    time: 0.2499  data: 0.0000  max mem: 5303
Evaluation: [1700/2856]  eta: 0:04:46    time: 0.2494  data: 0.0000  max mem: 5303
Evaluation: [1750/2856]  eta: 0:04:34    time: 0.2484  data: 0.0000  max mem: 5303
Evaluation: [1800/2856]  eta: 0:04:21    time: 0.2501  data: 0.0000  max mem: 5303
Evaluation: [1850/2856]  eta: 0:04:09    time: 0.2486  data: 0.0000  max mem: 5303
Evaluation: [1900/2856]  eta: 0:03:57    time: 0.2492  data: 0.0000  max mem: 5303
Evaluation: [1950/2856]  eta: 0:03:44    time: 0.2504  data: 0.0000  max mem: 5303
Evaluation: [2000/2856]  eta: 0:03:32    time: 0.2486  data: 0.0000  max mem: 5303
Evaluation: [2050/2856]  eta: 0:03:20    time: 0.2500  data: 0.0000  max mem: 5303
Evaluation: [2100/2856]  eta: 0:03:07    time: 0.2484  data: 0.0000  max mem: 5303
Evaluation: [2150/2856]  eta: 0:02:55    time: 0.2488  data: 0.0000  max mem: 5303
Evaluation: [2200/2856]  eta: 0:02:42    time: 0.2488  data: 0.0000  max mem: 5303
Evaluation: [2250/2856]  eta: 0:02:30    time: 0.2493  data: 0.0000  max mem: 5303
Evaluation: [2300/2856]  eta: 0:02:18    time: 0.2491  data: 0.0000  max mem: 5303
Evaluation: [2350/2856]  eta: 0:02:05    time: 0.2485  data: 0.0000  max mem: 5303
Evaluation: [2400/2856]  eta: 0:01:53    time: 0.2485  data: 0.0000  max mem: 5303
Evaluation: [2450/2856]  eta: 0:01:40    time: 0.2480  data: 0.0000  max mem: 5303
Evaluation: [2500/2856]  eta: 0:01:28    time: 0.2482  data: 0.0000  max mem: 5303
Evaluation: [2550/2856]  eta: 0:01:15    time: 0.2494  data: 0.0000  max mem: 5303
Evaluation: [2600/2856]  eta: 0:01:03    time: 0.2489  data: 0.0000  max mem: 5303
Evaluation: [2650/2856]  eta: 0:00:51    time: 0.2501  data: 0.0000  max mem: 5303
Evaluation: [2700/2856]  eta: 0:00:38    time: 0.2481  data: 0.0000  max mem: 5303
Evaluation: [2750/2856]  eta: 0:00:26    time: 0.2487  data: 0.0000  max mem: 5303
Evaluation: [2800/2856]  eta: 0:00:13    time: 0.2472  data: 0.0000  max mem: 5303
Evaluation: [2850/2856]  eta: 0:00:01    time: 0.2488  data: 0.0000  max mem: 5303
Evaluation: [2855/2856]  eta: 0:00:00    time: 0.2493  data: 0.0000  max mem: 5303
Evaluation: Total time: 0:11:49 (0.2484 s / it)
Evaluation: [   0/2856]  eta: 0:00:49    time: 0.0172  data: 0.0041  max mem: 5303
Evaluation: [  50/2856]  eta: 0:11:23    time: 0.2478  data: 0.0000  max mem: 5303
Evaluation: [ 100/2856]  eta: 0:11:18    time: 0.2482  data: 0.0000  max mem: 5303
Evaluation: [ 150/2856]  eta: 0:11:08    time: 0.2491  data: 0.0000  max mem: 5303
Evaluation: [ 200/2856]  eta: 0:10:57    time: 0.2490  data: 0.0000  max mem: 5303
Evaluation: [ 250/2856]  eta: 0:10:45    time: 0.2485  data: 0.0000  max mem: 5303
Evaluation: [ 300/2856]  eta: 0:10:33    time: 0.2490  data: 0.0000  max mem: 5303
Evaluation: [ 350/2856]  eta: 0:10:21    time: 0.2487  data: 0.0000  max mem: 5303
Evaluation: [ 400/2856]  eta: 0:10:09    time: 0.2491  data: 0.0000  max mem: 5303
Evaluation: [ 450/2856]  eta: 0:09:56    time: 0.2493  data: 0.0000  max mem: 5303
Evaluation: [ 500/2856]  eta: 0:09:44    time: 0.2482  data: 0.0000  max mem: 5303
Evaluation: [ 550/2856]  eta: 0:09:32    time: 0.2493  data: 0.0000  max mem: 5303
Evaluation: [ 600/2856]  eta: 0:09:19    time: 0.2488  data: 0.0000  max mem: 5303
Evaluation: [ 650/2856]  eta: 0:09:07    time: 0.2487  data: 0.0000  max mem: 5303
Evaluation: [ 700/2856]  eta: 0:08:55    time: 0.2488  data: 0.0000  max mem: 5303
Evaluation: [ 750/2856]  eta: 0:08:42    time: 0.2480  data: 0.0000  max mem: 5303
Evaluation: [ 800/2856]  eta: 0:08:30    time: 0.2485  data: 0.0000  max mem: 5303
Evaluation: [ 850/2856]  eta: 0:08:18    time: 0.2486  data: 0.0000  max mem: 5303
Evaluation: [ 900/2856]  eta: 0:08:05    time: 0.2493  data: 0.0000  max mem: 5303
Evaluation: [ 950/2856]  eta: 0:07:53    time: 0.2482  data: 0.0000  max mem: 5303
Evaluation: [1000/2856]  eta: 0:07:40    time: 0.2488  data: 0.0000  max mem: 5303
Evaluation: [1050/2856]  eta: 0:07:28    time: 0.2484  data: 0.0000  max mem: 5303
Evaluation: [1100/2856]  eta: 0:07:16    time: 0.2485  data: 0.0000  max mem: 5303
Evaluation: [1150/2856]  eta: 0:07:03    time: 0.2477  data: 0.0000  max mem: 5303
Evaluation: [1200/2856]  eta: 0:06:51    time: 0.2479  data: 0.0000  max mem: 5303
Evaluation: [1250/2856]  eta: 0:06:38    time: 0.2477  data: 0.0000  max mem: 5303
Evaluation: [1300/2856]  eta: 0:06:26    time: 0.2472  data: 0.0000  max mem: 5303
Evaluation: [1350/2856]  eta: 0:06:13    time: 0.2482  data: 0.0000  max mem: 5303
Evaluation: [1400/2856]  eta: 0:06:01    time: 0.2477  data: 0.0000  max mem: 5303
Evaluation: [1450/2856]  eta: 0:05:49    time: 0.2482  data: 0.0000  max mem: 5303
Evaluation: [1500/2856]  eta: 0:05:36    time: 0.2476  data: 0.0000  max mem: 5303
Evaluation: [1550/2856]  eta: 0:05:24    time: 0.2478  data: 0.0000  max mem: 5303
Evaluation: [1600/2856]  eta: 0:05:11    time: 0.2490  data: 0.0000  max mem: 5303
Evaluation: [1650/2856]  eta: 0:04:59    time: 0.2486  data: 0.0000  max mem: 5303
Evaluation: [1700/2856]  eta: 0:04:47    time: 0.2484  data: 0.0000  max mem: 5303
Evaluation: [1750/2856]  eta: 0:04:34    time: 0.2479  data: 0.0000  max mem: 5303
Evaluation: [1800/2856]  eta: 0:04:22    time: 0.2479  data: 0.0000  max mem: 5303
Evaluation: [1850/2856]  eta: 0:04:09    time: 0.2479  data: 0.0000  max mem: 5303
Evaluation: [1900/2856]  eta: 0:03:57    time: 0.2480  data: 0.0000  max mem: 5303
Evaluation: [1950/2856]  eta: 0:03:44    time: 0.2481  data: 0.0000  max mem: 5303
Evaluation: [2000/2856]  eta: 0:03:32    time: 0.2476  data: 0.0000  max mem: 5303
Evaluation: [2050/2856]  eta: 0:03:20    time: 0.2492  data: 0.0000  max mem: 5303
Evaluation: [2100/2856]  eta: 0:03:07    time: 0.2480  data: 0.0000  max mem: 5303
Evaluation: [2150/2856]  eta: 0:02:55    time: 0.2479  data: 0.0000  max mem: 5303
Evaluation: [2200/2856]  eta: 0:02:42    time: 0.2481  data: 0.0000  max mem: 5303
Evaluation: [2250/2856]  eta: 0:02:30    time: 0.2483  data: 0.0000  max mem: 5303
Evaluation: [2300/2856]  eta: 0:02:18    time: 0.2479  data: 0.0000  max mem: 5303
Evaluation: [2350/2856]  eta: 0:02:05    time: 0.2490  data: 0.0000  max mem: 5303
Evaluation: [2400/2856]  eta: 0:01:53    time: 0.2478  data: 0.0000  max mem: 5303
Evaluation: [2450/2856]  eta: 0:01:40    time: 0.2486  data: 0.0000  max mem: 5303
Evaluation: [2500/2856]  eta: 0:01:28    time: 0.2486  data: 0.0000  max mem: 5303
Evaluation: [2550/2856]  eta: 0:01:15    time: 0.2489  data: 0.0000  max mem: 5303
Evaluation: [2600/2856]  eta: 0:01:03    time: 0.2488  data: 0.0000  max mem: 5303
Evaluation: [2650/2856]  eta: 0:00:51    time: 0.2480  data: 0.0000  max mem: 5303
Evaluation: [2700/2856]  eta: 0:00:38    time: 0.2477  data: 0.0000  max mem: 5303
Evaluation: [2750/2856]  eta: 0:00:26    time: 0.2477  data: 0.0000  max mem: 5303
Evaluation: [2800/2856]  eta: 0:00:13    time: 0.2476  data: 0.0000  max mem: 5303
Evaluation: [2850/2856]  eta: 0:00:01    time: 0.2486  data: 0.0000  max mem: 5303
Evaluation: [2855/2856]  eta: 0:00:00    time: 0.2481  data: 0.0000  max mem: 5303
Evaluation: Total time: 0:11:48 (0.2482 s / it)
Evaluation time 0:24:49
Saved ranks to  output/itr_fashion200k_small/eval_ranks_i2t.pkl
Saved ranks to  output/itr_fashion200k_small/eval_ranks_t2i.pkl
{'txt_r1': 7.773109243697479, 'txt_r5': 23.319327731092436, 'txt_r10': 34.48879551820728, 'txt_r_mean': 21.86041083099907,
'img_r1': 5.742296918767507, 'img_r5': 21.603641456582633, 'img_r10': 34.2436974789916, 'img_r_mean': 20.529878618113912, 'r_mean': 21.195144724556492}
### Time 0:24:49
NNODES,  1
NPROC_PER_NODE,  8
MASTER_ADDR,  SET_IT
MASTER_PORT,  12345
NODE_RANK,  0
### warning: the settings for distributed training is not filled (ignore this if you only use one node)
### warning: you have not set the path to hadoop_bin (ignore this if you don't use HDFS)
