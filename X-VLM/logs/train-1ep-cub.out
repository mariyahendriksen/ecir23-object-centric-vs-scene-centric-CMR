Working with CUB!
Start training!
| distributed init (rank 0): env://
Creating model
### Loading pretrained vision encoder
Position interpolate vision_encoder.layers.0.blocks.0.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.0.blocks.1.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.1.blocks.0.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.1.blocks.1.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.0.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.1.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.2.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.3.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.4.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.5.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.6.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.7.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.8.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.9.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.10.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.11.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.12.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.13.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.14.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.15.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.16.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.2.blocks.17.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.3.blocks.0.attn.relative_position_bias_table from 13x13 to 23x23
Position interpolate vision_encoder.layers.3.blocks.1.attn.relative_position_bias_table from 13x13 to 23x23
### Loading pretrained text encoder
load checkpoint from /ivi/ilps/personal/mbiriuk/repro/X-VLM/4m_base_model_state_step_199999.th
missing_keys:  []
unexpected_keys:  ['bbox_head.0.weight', 'bbox_head.0.bias', 'bbox_head.1.weight', 'bbox_head.1.bias', 'bbox_head.3.weight', 'bbox_head.3.bias', 'text_encoder.cls.predictions.bias', 'text_encoder.cls.predictions.transform.dense.weight', 'text_encoder.cls.predictions.transform.dense.bias', 'text_encoder.cls.predictions.transform.LayerNorm.weight', 'text_encoder.cls.predictions.transform.LayerNorm.bias', 'text_encoder.cls.predictions.decoder.weight', 'text_encoder.cls.predictions.decoder.bias']
### Total Params:  213959547
Creating retrieval dataset
### output_dir,  output/itr_1ep_cub
Start training
### data 5994, batch size, 6 x 1
### lr_mult,  2
### num_training_steps,  999
### num_warmup_steps,  99
Train Epoch: [0] [  0/999]  eta: 0:33:09  lr: 0.000000  loss_itm: 0.8624  loss_itc: 2.7749  time: 1.9913  data: 0.7902  max mem: 7642
Train Epoch: [0] [ 50/999]  eta: 0:09:55  lr: 0.000015  loss_itm: 0.5287  loss_itc: 0.7168  time: 0.6017  data: 0.0001  max mem: 10122
Train Epoch: [0] [100/999]  eta: 0:09:14  lr: 0.000030  loss_itm: 0.3817  loss_itc: 1.3155  time: 0.6074  data: 0.0001  max mem: 10147
Train Epoch: [0] [150/999]  eta: 0:08:41  lr: 0.000028  loss_itm: 0.4623  loss_itc: 0.9148  time: 0.6090  data: 0.0001  max mem: 10157
Train Epoch: [0] [200/999]  eta: 0:08:09  lr: 0.000027  loss_itm: 0.7761  loss_itc: 1.6613  time: 0.6118  data: 0.0001  max mem: 10157
Train Epoch: [0] [250/999]  eta: 0:07:39  lr: 0.000025  loss_itm: 0.5093  loss_itc: 0.6253  time: 0.6148  data: 0.0001  max mem: 10157
Train Epoch: [0] [300/999]  eta: 0:07:08  lr: 0.000023  loss_itm: 0.5753  loss_itc: 1.5312  time: 0.6136  data: 0.0001  max mem: 10157
Train Epoch: [0] [350/999]  eta: 0:06:38  lr: 0.000022  loss_itm: 0.6227  loss_itc: 0.7593  time: 0.6149  data: 0.0001  max mem: 10157
slurmstepd: error: *** JOB 398718 ON ilps-cn106 CANCELLED AT 2022-09-29T11:56:58 ***
